<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Front-end Challenge</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <section id="page">
        <header>
            <ul class="nav nav-pills">
                <h1>Games</h1>
                <select name="alternador" id="" class="dropdown_border alternador">
                    <option value="teste" id="teste">
                        Mais populares
                    </option>
                    <option value="min_value">
                        Menor valor
                    </option>
                    <option value="max_value">
                        Maior Valor
                    </option>
                    <option value="teste">
                        Ordem alfabética A - Z
                    </option>
                </select>
            </ul>
        </header>
        <nav>
            <div class="carrinho" id="carrinho">
                <h3>Carrinho</h3>
                <div class="logo_carrinho">
                    <img src="assets/cart-icon.svg" alt="">
                </div> 
                <div class="text_style"> 
                    <p>Até o momento, <br>o seu carrinho está vazio</p>
                </div>
            </div>
        </nav>
        <main>
            <table id="produtos_jogos">
            </table>
        </main>
    </section>

    <footer>
    </footer>





    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js" integrity="sha256-T0Vest3yCU7pafRw9r+settMBX6JkKN06dqBnpQ8d30=" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
    <script type="text/javascript">
        var xmlhttp = new XMLHttpRequest();                             //criação da variável para inicialização do JSON
        xmlhttp.onreadystatechange = function() {   
            if (this.readyState == 4 && this.status == 200) {
                var myObj = JSON.parse(this.responseText);
                var linhas = myObj.length / 3
                var cont = 0
                for (i = 0; i < linhas; i++){
                    var tr = document.createElement("tr");                          //criação do elemento tr para a table
                    tr.setAttribute('class', 'products-grid')
                    document.getElementById("produtos_jogos").appendChild(tr)       //get do id da table no HTML        
                    for(j = 0; j < 3; j++){ 
                        var th = document.createElement("th")               //variável do elemento TH da tabela dos produtos
                        var div = document.createElement("div")             //variável da div da tabela dos produtos
                        var div_text = document.createElement("div")        //variável da div com o nome e o valor da tabela dos produtos                          
                        div.setAttribute('class','borda_table')             //atribuição da classe css da div da tabela
                        div.setAttribute('id',myObj[cont].id)               //atribuição do id do JSON há div das imagens
                        div_text.setAttribute('id', 'div_text')             //atribuição do id na div com os nomes e os valores
                        tr.appendChild(th)                                  
                        th.appendChild(div)
                        th.appendChild(div_text)

                        var img = document.createElement("img")                 //criação do elemento img
                        img.setAttribute('src','assets/' + myObj[cont].image)   //get da imagem dentro do JSON
                        img.setAttribute('class', 'img_md')                     //atribuição de class na tag img
                        div.appendChild(img)                                    //input da tag img dentro da div da tabela

                        var p = document.createElement("p")                     //criação da tag p para input dos nomes dos produtos
                        p.setAttribute('class','txt_game')                      //atribuição da class 

                        p.textContent = myObj[cont].name                        //get do elemento name no JSON
                        div_text.appendChild(p)                                 //input da tag p na div de textos

                        var p_preco = document.createElement("p")               //criação da tag p para input do valor dos produtos
                        p_preco.setAttribute('class', 'txt_game txt_preco product')     //atribuição da class no p
                        p_preco.textContent = 'R$ ' + myObj[cont].price         //get do elemento price no JSON               
                        div_text.appendChild(p_preco)                           //input da ta p na div dos valores
                            

                       $(function(){                       //função hover para o botão do carrinho
                            $("#div_text").hover(
                                function(){
                                    $(this).html("<button type='submit' id='enviar'>teste</button>");
                                    
                                },
                                function(){
                                    //Ao remover o cursor da div
                                    $(this).css('background', 'white');
                                } 
                            )                
                        });

                        $(document).on("alternador", function(){
                            var min_max = $(this).val();

                            if(min_max == 'min_value'){
                                busca_val_min()
                            }
                            else if(min_max == 'max_value'){
                                busca_val_max()
                            }
                        })

                        function busca_val_min(){
                            var products = $('.product')
                            products.sort(function(a, b){ return $(b).data(myObj[cont].price)-$(b).data(myObj[cont].price)})
                            $(".products-grid").html(products)
                        }

                        function busca_val_max(){
                            var products = $('.product')
                            products.sort(function(a, b){ return $(b).data(myObj[cont].price)-$(a).data(myObj[cont].price)})
                            $(".products-grid").html(products)
                        }
                        
                        
                        
                        cont++
                    }
                }

            }
        };
        
xmlhttp.open("GET", "http://costin.com.br/challenge-cr/products.json", true);
xmlhttp.send();
    </script>
</body>
</html>